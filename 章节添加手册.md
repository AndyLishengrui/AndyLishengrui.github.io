# 圣经章节添加手册

## 概述

本手册记录了为圣经学习平台系统性添加和完善福音书章节经文的完整工作流程。基于马可福音（100%完成）和路加福音（当前20.2%完成）的成功实践经验。

## 项目结构

```
web2Lord/
├── data/
│   ├── matthew.json     # 马太福音（已完成100%）
│   ├── mark.json        # 马可福音（已完成100%，678节）
│   ├── luke.json        # 路加福音（进行中，24章1151节）
│   └── john.json        # 约翰福音（待完善）
├── index.html           # 主页面
├── study.html          # 学习页面
└── 章节添加手册.md      # 本手册
```

## 完整章节补充工作流程

### 第一步：评估现状

使用以下命令检查福音书的完成情况：

```bash
# 检查特定福音书的总体状态
python3 -c "
import json
data = json.load(open('data/luke.json'))
print(f'路加福音总进度：{len(data[\"verses\"])}/1151节 ({len(data[\"verses\"])/1151*100:.1f}%)')

# 按章节分析完成情况
for ch in range(1, 25):
    ch_verses = [v for v in data['verses'] if v['chapter'] == ch]
    if len(ch_verses) > 0:
        print(f'第{ch}章：{len(ch_verses)}节')
"
```

### 第二步：检查特定章节状态

```bash
# 检查某一章的具体情况
python3 -c "
import json
data = json.load(open('data/luke.json'))
ch4_verses = [v for v in data['verses'] if v['chapter'] == 4]
verses_list = sorted([v['verse'] for v in ch4_verses])
print(f'第4章现有经文：{len(ch4_verses)}节')
print(f'现有经文编号：{verses_list}')
"
```

### 第三步：系统性补充章节

#### 方法A：单章完整添加

当某章完全缺失或只有少数几节时，使用 `multi_replace_string_in_file` 工具一次性添加整章：

**成功案例：路加福音第1章补充（38-80节）**
```json
{
  "explanation": "添加路加福音第1章38-80节",
  "replacements": [
    {
      "oldString": "精确定位现有最后一节的位置",
      "newString": "插入缺失的所有经文",
      "filePath": "/path/to/luke.json"
    }
  ]
}
```

#### 方法B：分段插入

当某章已有部分经文时，分段插入缺失部分：

**成功案例：路加福音第4章补充**
- 先插入1-17节（耶稣受试探和传道开始）
- 后插入19-44节（拿撒勒被拒绝、医治事工）

```json
[
  {
    "explanation": "在第4章18节前插入1-17节",
    "oldString": "准确匹配18节的上下文",
    "newString": "插入1-17节完整经文",
    "filePath": "/path/to/luke.json"
  },
  {
    "explanation": "在第4章18节后插入19-44节", 
    "oldString": "准确匹配18节的结束位置",
    "newString": "插入19-44节完整经文",
    "filePath": "/path/to/luke.json"
  }
]
```

### 第四步：JSON格式规范

每个经文条目必须遵循以下格式：

```json
{
  "chapter": 4,
  "verse": 18,
  "zh": "主的灵在我身上，因为他用膏膏我，叫我传福音给贫穷的人；差遣我报告：被掳的得释放，瞎眼的得看见，叫那受压制的得自由，",
  "en": "The Spirit of the Lord is on me, because he has anointed me to proclaim good news to the poor. He has sent me to proclaim freedom for the prisoners and recovery of sight for the blind, to set the oppressed free,"
}
```

**格式要点：**
- `chapter`: 章节号（数字）
- `verse`: 节号（数字）  
- `zh`: 中文经文（和合本）
- `en`: 英文经文（NIV或类似译本）
- 中英文经文末尾的标点符号要准确

### 第五步：验证和测试

完成添加后必须进行验证：

```bash
# 验证JSON格式正确性
python3 -c "
import json
try:
    data = json.load(open('data/luke.json'))
    print('✅ JSON格式正确！')
except Exception as e:
    print(f'❌ JSON格式错误：{e}')
"

# 验证章节完整性
python3 -c "
import json
data = json.load(open('data/luke.json'))

# 检查特定章节是否完整（以第4章为例，应有44节）
ch4_verses = [v for v in data['verses'] if v['chapter'] == 4]
if len(ch4_verses) == 44:
    print('✅ 第4章完整')
else:
    expected = set(range(1, 45))
    actual = set([v['verse'] for v in ch4_verses])
    missing = expected - actual
    print(f'❌ 第4章缺失：{sorted(missing)}')
"
```

## 各福音书章节信息

### 路加福音章节结构（24章，1151节）

| 章节 | 节数 | 主要内容 | 状态 |
|------|------|----------|------|
| 第1章 | 80节 | 天使报信、马利亚颂歌、施洗约翰诞生 | ✅ 完成 |
| 第2章 | 52节 | 耶稣降生、牧羊人、西面颂歌 | ✅ 完成 |
| 第3章 | 38节 | 约翰事工、耶稣受洗、家谱 | ✅ 完成 |
| 第4章 | 44节 | 耶稣受试探、拿撒勒被拒、迦百农事工 | ✅ 完成 |
| 第5章 | 39节 | 呼召门徒、医治麻风病人 | 🔄 部分 |
| 第6章 | 49节 | 拣选十二门徒、平原宝训 | 🔄 部分 |
| 第7章 | 50节 | 百夫长的信心、寡妇之子复活 | ⏳ 待开始 |
| 第8章 | 56节 | 撒种比喻、平静风浪 | ⏳ 待开始 |
| ... | ... | ... | ... |

### 马太福音（已完成，28章）
- **状态**：✅ 完成（100%）
- **特点**：包含完整的山上宝训、比喻教导、受难复活

### 马可福音（已完成，16章，678节）  
- **状态**：✅ 完成（100%）
- **特点**：最简洁的福音书，注重行动和神迹

### 约翰福音（待完善，21章）
- **状态**：🔄 需要评估和补充
- **特点**：神学性最强，包含"我是"宣告和告别讲论

## 工作原则

### 1. 系统性原则
- 按章节顺序系统完成，不跳跃
- 每章完成后立即验证，确保质量
- 记录进度，便于跟踪

### 2. 准确性原则
- 经文内容必须准确，对照权威译本
- JSON格式必须严格遵守规范
- 章节号、节号必须正确无误

### 3. 效率性原则
- 优先使用 `multi_replace_string_in_file` 进行批量操作
- 合理规划插入点，减少工具调用次数
- 预先准备经文内容，避免重复查找

### 4. 完整性原则
- 确保每章经文完整，不遗漏任何一节
- 保持中英文对照完整
- 验证总体进度和各章完成状态

## 常用命令集

### 快速状态检查

```bash
# 检查所有福音书状态
for book in matthew mark luke john; do 
    echo "=== $book.json ==="
    python3 -c "import json; data=json.load(open('data/$book.json')); print(f'经文数量: {len(data[\"verses\"])}个')"
done
```

### 进度追踪

```bash
# 路加福音详细进度
python3 -c "
import json
data = json.load(open('data/luke.json'))
completed = []
for ch in range(1, 25):
    verses = [v for v in data['verses'] if v['chapter'] == ch]
    if len(verses) > 0:
        completed.append(f'第{ch}章({len(verses)}节)')
print('已有章节：', ', '.join(completed[:10]))
print(f'总进度：{len(data[\"verses\"])}/1151节 ({len(data[\"verses\"])/1151*100:.1f}%)')
"
```

## 成功完成案例

### 路加福音第1章补充（从42节到80节）
**挑战**：缺失38节经文，包含马利亚颂歌、施洗约翰诞生等重要内容
**解决**：使用 `multi_replace_string_in_file` 一次性插入所有缺失经文
**结果**：✅ 成功完成80节完整章节

### 路加福音第2章补充（从2节到52节）  
**挑战**：几乎整章缺失，包含耶稣诞生叙述
**解决**：精确定位现有经文，分段插入完整内容
**结果**：✅ 成功完成52节完整章节

### 路加福音第3章补充（从1节到38节）
**挑战**：只有第16节，需要添加约翰事工和家谱
**解决**：在16节前后分别插入1-15节和17-38节
**结果**：✅ 成功完成38节完整章节

### 路加福音第4章补充（从1节到44节）
**挑战**：只有第18节，需要添加受试探和医治事工
**解决**：使用分段插入法，先添加1-17节，后添加19-44节
**结果**：✅ 成功完成44节完整章节

## 下一步计划

### 路加福音完成计划
1. ✅ 第1-4章（已完成，232/1151节，20.2%）
2. 🔄 第5-8章（耶稣早期事工）
3. ⏳ 第9-12章（门徒训练）
4. ⏳ 第13-19章（耶路撒冷之旅）
5. ⏳ 第20-24章（受难与复活）

### 约翰福音评估和规划
- 评估现有内容完成度
- 制定系统补充计划
- 重点关注独特内容（如第14-17章告别讲论）

## 质量保证

### 每章完成后检查清单
- [ ] JSON格式验证通过
- [ ] 章节经文数量正确
- [ ] 中英文内容完整
- [ ] 没有重复或遗漏
- [ ] 进度统计更新

### 阶段性验证
- 每完成5章进行一次全面检查
- 定期备份数据文件
- 测试网页显示效果

## 技术参考

### 文件路径
- 数据文件：`/Users/andyshengruilee/Documents/website/web2Lord/data/`
- 主要工具：`multi_replace_string_in_file`、`read_file`、`run_in_terminal`

### JSON结构

```json
{
  "book": "Luke",
  "chapters": 24,
  "verses": [
    {
      "chapter": 1,
      "verse": 1,
      "zh": "中文经文",
      "en": "English verse"
    }
  ]
}
```

---

**创建日期**：2025年10月2日  
**最后更新**：路加福音第4章完成（232/1151节，20.2%）  
**下一目标**：完成路加福音第5章（39节）

## 质量检查清单

### 数据质量
- [ ] JSON格式正确无语法错误
- [ ] 所有必需字段都已填写
- [ ] 中英文经文对应正确
- [ ] keyVerses引用的经文在verses数组中存在
- [ ] 章节号和节号准确无误

### 功能测试
- [ ] 书卷页面能正常加载
- [ ] 填空练习功能正常
- [ ] 章节切换功能正常
- [ ] 预览/复习/黄金经文模式都能正常工作
- [ ] 进度保存和读取功能正常

### 用户体验
- [ ] 书卷描述准确且有意义
- [ ] 颜色选择与主题匹配
- [ ] 导航卡片显示正常
- [ ] 响应式设计在移动设备上正常显示

## 常见问题解决

### JSON格式错误
- 检查是否缺少逗号或括号
- 确认字符串使用双引号
- 验证数组和对象语法正确

### 页面加载失败
- 检查config.json中是否正确添加了书卷
- 确认文件名与englishName一致
- 检查HTTP服务器是否正常运行

### 功能异常
- 检查keyVerses中引用的经文是否在verses数组中存在
- 确认章节号格式正确（数字类型）
- 检查浏览器控制台是否有JavaScript错误

## 示例：马太福音添加过程

1. **创建data/matthew.json**：
   ```json
   {
     "name": "马太福音",
     "englishName": "matthew",
     "color": "#3498db",
     "description": "记录耶稣基督的生平、教导和救赎工作，强调祂是应许的弥赛亚",
     "chapters": 28,
     "verses": [...],
     "keyVerses": [...]
   }
   ```

2. **更新config.json**：
   ```json
   "availableBooks": ["romans", "ephesians", "matthew"]
   ```

3. **更新index.html**：
   ```html
   <div class="book-card" onclick="openBook('matthew')">
     <div class="book-icon" style="background: #3498db;">
       <i class="fas fa-book-open"></i>
     </div>
     <div class="book-info">
       <h3>马太福音</h3>
       <p>记录耶稣基督的生平、教导和救赎工作</p>
     </div>
   </div>
   ```

4. **验证和测试**：完成所有质量检查清单项目

## 维护和更新

### 添加新经文
1. 在verses数组中添加新的经文对象
2. 在keyVerses数组中添加对应引用
3. 重新验证JSON格式

### 修改现有经文
1. 找到对应的verses数组项
2. 更新中文或英文文本
3. 保持章节和节号不变

### 调整重点经文
1. 修改keyVerses数组
2. 确保引用的经文在verses中存在
3. 测试练习功能正常

---

*本手册基于圣经学习平台的实际开发经验编写，涵盖了从数据创建到功能测试的完整流程。*